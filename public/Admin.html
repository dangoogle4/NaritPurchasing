<!DOCTYPE html>
<html>
<style>
body {
	 background-color: #91ced4;
}
 body * {
	 box-sizing: border-box;
}
 .header {
	 background-color: #327a81;
	 color: white;
	 font-size: 1.5em;
	 padding: 1rem;
	 text-align: center;
	 text-transform: uppercase;
}
 img {
	 border-radius: 50%;
	 height: 60px;
	 width: 60px;
}
 .table-users {
	 border: 1px solid #327a81;
	 border-radius: 10px;
	 box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.1);
	 max-width: calc(100% - 2em);
	 margin: 1em auto;
	 overflow: hidden;
	 width: 800px;
}
 table {
	 width: 100%;
}
 table td, table th {
	 color: #2b686e;
	 padding: 10px;
}
 table td {
	 text-align: center;
	 vertical-align: middle;
}
 table td:last-child {
	 font-size: 0.95em;
	 line-height: 1.4;
	 text-align: left;
}
 table th {
	 background-color: #daeff1;
	 font-weight: 300;
}
 table tr:nth-child(2n) {
	 background-color: white;
}
 table tr:nth-child(2n+1) {
	 background-color: #edf7f8;
}
 @media screen and (max-width: 700px) {
	 table, tr, td {
		 display: block;
	}
	 td:first-child {
		 position: absolute;
		 top: 50%;
		 transform: translateY(-50%);
		 width: 100px;
	}
	 td:not(:first-child) {
		 clear: both;
		 margin-left: 100px;
		 padding: 4px 20px 4px 90px;
		 position: relative;
		 text-align: left;
	}
	 td:not(:first-child):before {
		 color: #91ced4;
		 content: '';
		 display: block;
		 left: 0;
		 position: absolute;
	}
	 td:nth-child(2):before {
		 content: 'Name:';
	}
	 td:nth-child(3):before {
		 content: 'Email:';
	}
	 td:nth-child(4):before {
		 content: 'Phone:';
	}
	 td:nth-child(5):before {
		 content: 'Comments:';
	}
	 tr {
		 padding: 10px 0;
		 position: relative;
	}
	 tr:first-child {
		 display: none;
	}
}
 @media screen and (max-width: 500px) {
	 .header {
		 background-color: transparent;
		 color: #fff;
		 font-size: 2em;
		 font-weight: 700;
		 padding: 0;
		 text-shadow: 2px 2px 0 rgba(0, 0, 0, 0.1);
	}
	 img {
		 border: 3px solid;
		 border-color: #daeff1;
		 height: 100px;
		 margin: 0.5rem 0;
		 width: 100px;
	}
	 td:first-child {
		 background-color: #c8e7ea;
		 border-bottom: 1px solid #91ced4;
		 border-radius: 10px 10px 0 0;
		 position: relative;
		 top: 0;
		 transform: translateY(0);
		 width: 100%;
	}
	 td:not(:first-child) {
		 margin: 0;
		 padding: 5px 1em;
		 width: 100%;
	}
	 td:not(:first-child):before {
		 font-size: 0.8em;
		 padding-top: 0.3em;
		 position: relative;
	}
	 td:last-child {
		 padding-bottom: 1rem !important;
	}
	 tr {
		 background-color: white !important;
		 border: 1px solid #6cbec6;
		 border-radius: 10px;
		 box-shadow: 2px 2px 0 rgba(0, 0, 0, 0.1);
		 margin: 0.5rem 0;
		 padding: 0;
	}
	 .table-users {
		 border: none;
		 box-shadow: none;
		 overflow: visible;
	}
  
}
 
</style>

<body onload="showData()" >
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <nav class="navbar navbar-inverse">
    <div class="container-fluid">
      <div class="navbar-header">
        <a class="navbar-brand" href="#">WebSiteName</a>
      </div>
      <ul class="nav navbar-nav">
        <li class="active"><a href="#">Home</a></li>
        <li><a href="/main">Page 1</a></li>
        <li><a href="/main">Page 2</a></li>
        <li><a href="/">Page 3</a></li>
      </ul>
    </div>
  </nav>
  <div id="Home" class="tabcontent">
    <h3>Home</h3>
    <div>
        <form>
          รหัสการชื้อ 
          <input name="first" type="text">
             
          ชื่องบประมาณ
          <input  name="last" type="text">
            
          ราคารวมทั้งหมดของทุกชิ้น
          <input  name="lastmak" type="text">
    
          <!--<button >ค้นหา</button>-->
        </form>
        <br>
    
    
        <div class="header">Users</div>
        
        <table cellspacing="0">
           <tr>
              <td>ลำดับ </td>
              <td>ชื่อวัสดุ</td>
              <td>Part Number</td>
              <td>ราคา(เสนอ)</td>
              <td>จำนวน(เสนอ)</td>
              <td>ราคา(แก้ไข)</td>
              <td>จำนวน(แก้ไข)</td>
              <td>ราคารวม</td>
              <td>ผู้รับผิดชอบ</td>
              <td>รูป</td>
              <td width="230">สถานะ</td>
              <tbody id="room-namedata"></tbody>
           </tr>
     
           <!-- <tr>
              <td>1</td>
              <td><a href="/">NewNewNew</a></td>
              <td>jane.doe@foo.com</td>
              <td><input name="first" type="text"></td>
              <td>Lorem ipsum dolor sit amet, consectetur adipisicing elit. </td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
              <td>
                <input type="button" id="button" value = "สถานะ" style= "color:rgb(0, 0, 0)" onclick="setColor('button', '#000000')";/>
               -->
        </table>
     </div>
     <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">เพิ่มข้อมูล</button>
    
      <!-- Modal -->
      <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
        
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">Modal Header</h4>
            </div>
            <div class="modal-body">
              <form>
                <label>ชื่อร้าน</label>
                <input name="first" type="text"><br>
                <br>
                <label>ชื่อวัสดุ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>Part Number</label>
                <input name="first" type="text"><br>  
                <br>
                <label>ราคา</label>
                <input  name="last" type="text"><br>
                <br>
                <label>จำนวน</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ราคารวม</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ผู้รับผิดชอบ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>สถานะ</label>
                <input  name="last" type="text"><br>
                <div class="form-group">
                    <label for="img">รูป:</label>
                    <input type="file" id="img" name="img" accept="image/*">
                </div>
                <br>
                <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">เพิ่มข้อมูล</button>
                <input class="btn btn-info btn-lg" type="reset" value="Reset">
                </form>    
            </div>
            <div class="modal-footer">
              
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
          
        </div>
      </div>
  </div>
  
  <div id="News" class="tabcontent">
    <h3>News</h3>
    <div>
        <form>
          รหัสการชื้อ 
          <input name="first" type="text">
             
          ชื่องบประมาณ
          <input  name="last" type="text">
            
          ราคารวมทั้งหมดของทุกชิ้น
          <input  name="lastmak" type="text">
    
          <!--<button >ค้นหา</button>-->
        </form>
        <br>
    
    
        <div class="header">Users</div>
        
        <table cellspacing="0">
           <tr>
              <th>ลำดับ </th>
              <th>ชื่อวัสดุ</th>
              <th>Part Number</th>
              <th>ราคา</th>
              <th>จำนวน</th>
              <th>ราคารวม</th>
              <th>ผู้รับผิดชอบ</th>
              <th>รูป</th>
              <th width="230">สถานะ</th>
           </tr>
     
           <tr>
              <td>1</td>
              <td><a href="/">NewNewNew</a></td>
              <td>jane.doe@foo.com</td>
              <td>01 800 2000</td>
              <td>Lorem ipsum dolor sit amet, consectetur adipisicing elit. </td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
           </tr>
          
        </table>
     </div>
     <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">เพิ่มข้อมูล</button>
    
      <!-- Modal -->
      <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
        
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">Modal Header</h4>
            </div>
            <div class="modal-body">
              <form>
                <label>ชื่อร้าน</label>
                <input name="first" type="text"><br>
                <br>
                <label>ชื่อวัสดุ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>Part Number</label>
                <input name="first" type="text"><br>  
                <br>
                <label>ราคา</label>
                <input  name="last" type="text"><br>
                <br>
                <label>จำนวน</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ราคารวม</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ผู้รับผิดชอบ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>สถานะ</label>
                <input  name="last" type="text"><br>
                <div class="form-group">
                    <label for="img">รูป:</label>
                    <input type="file" id="img" name="img" accept="image/*">
                </div>
                <br>
                <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">เพิ่มข้อมูล</button>
                <input class="btn btn-info btn-lg" type="reset" value="Reset">
                </form>    
            </div>
            <div class="modal-footer">
              
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
          
        </div>
      </div>
  </div>
  
  <div id="Contact" class="tabcontent">
    <h3>Contact</h3>
    <div>
        <form>
          รหัสการชื้อ 
          <input name="first" type="text">
             
          ชื่องบประมาณ
          <input  name="last" type="text">
            
          ราคารวมทั้งหมดของทุกชิ้น
          <input  name="lastmak" type="text">
    
          <!--<button >ค้นหา</button>-->
        </form>
        <br>
    
    
        <div class="header">Users</div>
        
        <table cellspacing="0">
           <tr>
              <th>ลำดับ </th>
              <th>ชื่อวัสดุ</th>
              <th>Part Number</th>
              <th>ราคา</th>
              <th>จำนวน</th>
              <th>ราคารวม</th>
              <th>ผู้รับผิดชอบ</th>
              <th>รูป</th>
              <th width="230">สถานะ</th>
           </tr>
     
           <tr>
              <td>1</td>
              <td><a href="/">NewNewNew</a></td>
              <td>jane.doe@foo.com</td>
              <td>01 800 2000</td>
              <td>Lorem ipsum dolor sit amet, consectetur adipisicing elit. </td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
           </tr>
         
        </table>
     </div>
     <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">เพิ่มข้อมูล</button>
    
      <!-- Modal -->
      <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
        
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">Modal Header</h4>
            </div>
            <div class="modal-body">
              <form>
                <label>ชื่อร้าน</label>
                <input name="first" type="text"><br>
                <br>
                <label>ชื่อวัสดุ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>Part Number</label>
                <input name="first" type="text"><br>  
                <br>
                <label>ราคา</label>
                <input  name="last" type="text"><br>
                <br>
                <label>จำนวน</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ราคารวม</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ผู้รับผิดชอบ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>สถานะ</label>
                <input  name="last" type="text"><br>
                <div class="form-group">
                    <label for="img">รูป:</label>
                    <input type="file" id="img" name="img" accept="image/*">
                </div>
                <br>
                <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">เพิ่มข้อมูล</button>
                <input class="btn btn-info btn-lg" type="reset" value="Reset">
                </form>    
            </div>
            <div class="modal-footer">
              
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
          
        </div>
      </div>
  </div>
  
  <div id="About" class="tabcontent">
    <h3>About</h3>
    <div>
        <form>
          รหัสการชื้อ 
          <input name="first" type="text">
             
          ชื่องบประมาณ
          <input  name="last" type="text">
            
          ราคารวมทั้งหมดของทุกชิ้น
          <input  name="lastmak" type="text">
    
          <!--<button >ค้นหา</button>-->
        </form>
        <br>
    
    
        <div class="header">Users</div>
        
        <table cellspacing="0">
           <tr>
              <th>ลำดับ </th>
              <th>ชื่อวัสดุ</th>
              <th>Part Number</th>
              <th>ราคา</th>
              <th>จำนวน</th>
              <th>ราคารวม</th>
              <th>ผู้รับผิดชอบ</th>
              <th>รูป</th>
              <th width="230">สถานะ</th>
           </tr>
     
           <tr>
              <td>1</td>
              <td><a href="/">NewNewNew</a></td>
              <td>jane.doe@foo.com</td>
              <td>01 800 2000</td>
              <td>Lorem ipsum dolor sit amet, consectetur adipisicing elit. </td>
              <td><input name="first" type="text"></td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
           </tr>
          
        </table>
     </div>
     <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">เพิ่มข้อมูล</button>
    
      <!-- Modal -->
      <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
        
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">Modal Header</h4>
            </div>
            <div class="modal-body">
              <form id="headerTable">
                <label>ชื่อร้าน</label>
                <input name="first" type="text"><br>
                <br>
                <label>ชื่อวัสดุ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>Part Number</label>
                <input name="first" type="text"><br>  
                <br>
                <label>ราคา</label>
                <input  name="last" type="text"><br>
                <br>
                <label>จำนวน</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ราคารวม</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ผู้รับผิดชอบ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>สถานะ</label>
                <input  name="last" type="text"><br>
                <div class="form-group">
                    <label for="img">รูป:</label>
                    <input type="file" id="img" name="img" accept="image/*">
                </div>
                <br>
                <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">เพิ่มข้อมูล</button>
                <input class="btn btn-info btn-lg" type="reset" value="Reset">
                </form>    
            </div>
            <div class="modal-footer">
              
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
          
          
        </div>
      </div>
  </div>
  <br>
  <button class="tablink" onclick="openPage('Home', this, 'red')" id="defaultOpen">ร้านแรก</button>
  <button class="tablink" onclick="openPage('News', this, 'green')" >ร้านสอง</button>
  <button class="tablink" onclick="openPage('Contact', this, 'blue')">ร้านสาม</button>
  <button class="tablink" onclick="openPage('About', this, 'orange')">ร้านสี่</button>
<br>
<br>
        สถานะการจัดชื้อ:
        <select>
            <option value="">รออนุมัติ / อนุมัติ /ตรวจรับแล้ว/ รอส่งของ <option>
            <option value="1">รออนุมัติ</option>
            <option value="2">อนุมัติ</option>
            <option value="3">ตรวจรับแล้ว</option>
            <option value="4">รอส่งของ</option>
          </select>
          <br>
          <br>
          <br>
        หมายเหตุ:  
        <textarea id="w3review" name="w3review" rows="4" cols="50">
            
        </textarea>

        <iframe id="txtArea1" style="display:none"></iframe>
            <br><br>
            <input  onclick="goToTable()" type="submit" value="Submit">

            <button class="btn btn-info" onclick="Export()">export &nbsp;</button>
        
  
        <!--<button >ค้นหา</button>-->
    
  

</body>
</html>

<script>
    function goToTable() {
        alert("Hello! I am an alert box!");
      window.location.href = "/main";
    }
  </script>

<script>
    function openPage(pageName,elmnt,color) {
      var i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablink");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].style.backgroundColor = "";
      }
      document.getElementById(pageName).style.display = "block";
      elmnt.style.backgroundColor = color;
    }
    
    // Get the element with id="defaultOpen" and click on it
    document.getElementById("defaultOpen").click();
    </script>

<script>

    var count = 1;
    function setColor(btn, color) {
        var property = document.getElementById(btn);
        if (count == 0) {
            property.style.backgroundColor = "#FF0000"
            count = 2;        
        }
        else if(count == 2){
            property.style.backgroundColor = "#00FF00"
            count = 3;
        }
        else{
            property.style.backgroundColor = "#0000FF"
            count = 0;
        }
    }

</script>
<script>
function Export(){
  var csv = [];
  var rows = document.querySelectorAll("table tr");
  // console.log(rows);
    for (var i = 0; i < rows.length; i++) 
    {
      var row = [], cols = rows[i].querySelectorAll("td, th");
      
          for (var j = 0; j < cols.length-1; j++)
          {
            row.push(cols[j].innerText);
          } 
      csv.push(row.join(","));    
    }
    // console.log(csv);
    // Download CSV
    download_csv(csv.join("\n"), "export.csv");
}
function download_csv(csv, filename) {
  var csvFile;
  var downloadLink;

  // CSV FILE
  csvFile = new Blob([
            new Uint8Array([0xEF, 0xBB, 0xBF]), // UTF-8 BOM
            csv
            ],
            { type: "text/csv;charset=utf-8" });

  // Download link
  downloadLink = document.createElement("a");

  // File name
  downloadLink.download = filename;

  // We have to create a link to the file
  downloadLink.href = window.URL.createObjectURL(csvFile);

  // Make sure that the link is not displayed
  downloadLink.style.display = "none";

  // Add the link to your DOM
  document.body.appendChild(downloadLink);

  // Lanzamos
  downloadLink.click();
}



function showData() {
    
		
    $.post("/get/data", function (data, status) {
      console.log(data);
		//document.getElementById("room-name").innerHTML="";
      for (let i = 0; i < data.length; i++) {
		  //console.log(data[i]._id);
		  str = data[i]._id.replace(/\s/g, '');
		  console.log(str);
        roomId = data;
		// let rstripId = data[i]._id.rs
        //$("#room-name-value").val(data[0].room);
        $("#room-namedata").append(
		  "<tr><td>" +
            (i + 1) +
            "</td>" +
            "<td id='order"+i+"'>" +
            data[i].shop +
			"</td>" +
			"<td>" +
            data[i].item +
			"</td>" +
			"<td>" +
            data[i].partnumber +
			"</td>" +
			"<td>" +
            data[i].price +
			"</td>" +
			"<td>" +
            data[i].amount +
      "</td>" +
      "<td>" +
            data[i].sumprice +
      "</td>" +
      "<td>" +
            data[i].responsibleperson +
      "</td>" +
      "<td>" +
            data[i].statusz +
      "</td>" +
			// "<td>" +
			// <a data-toggle="modal" data-target="#Modalzz">แก้ไข</a> +
			// "</td>" +
			 "<td><a data-toggle='modal' data-target='#ModalForEditData'   onclick='editData("+i+")' >แก้ไข</a>" +
				//"<td><a data-toggle='modal' data-target='#Modalzz' data-target='#exampleModal02' onclick='save()' >แก้ไข</a>" +
            "<div class='modal fade' id='exampleModal02' tabindex='-1' role='dialog' aria-labelledby='exampleModal02Label' aria-hidden='true' data-backdrop='static' data-keyboard='false'>" +
            "<div class='modal-dialog modal-dialog-centered'>" +
            "<div class='modal-content'>" +
            "<div class='modal-header'>" +
            "<h5 class='modal-title'  id='exampleModal02Label'>แก้ไข</h5>" +
            "<button type='button' class='close' data-dismiss='modal' aria-label='Close'>" +
            "<span aria-hidden='true'>&times;</span>" +
            "</button>" +
            "</div>" +
            "<div class='modal-footer'>" +
            "<button type='button' class='btn btn-secondary' data-dismiss='modal'>ยกเลิก</button>" +
            "</div>" +
            "</div></td>" +
            "<td><button href='#' onclick=dropDataKrub('"+str.toString()+"') >ลบ</button></td>" +
			"</tr>"
			

        );
      }
    });
  }


</script>